jQuery(document).ready(function(a){function c(){a("#unvalidated_rating").prop("name","rating"),a("#unvalidated_rating").prop("id","rating"),a("#title").val(""),a("textarea#comment").val(""),a("form#commentform").removeClass("edit-review"),a("form#commentform input#review_id").remove(),a("p.comment-form-rating").show(),a("p.upload_section").show(),a(".review_label").text(ywar.add_review_title),a("#cancel-comment-reply-link").is(":visible")&&a("#cancel-comment-reply-link").click()}function d(b){a(b).block({message:null,overlayCSS:{background:"#fff url("+ywar.loader+") no-repeat center",opacity:.6}})}function e(b){var c=a(b).attr("data-id_product"),d=a(b).attr("data-order"),e=a(b).attr("data-stars"),f=a(b).attr("data-page"),g=a(b).attr("data-dialog"),h={action:"get_ajax_comments",product_id:c,stars:e,order:d,data_page:f,is_modal:g,_wpnonce:ywar.nonce_value,return_path:window.location.href};return h}a("body").off("click","#respond #submit");var b='<div id="modal_reviews" class="pp_pic_holder"><a class="pp_close" href="#"></a><div class="pp_content_container"><div class="pp_left"><div class="pp_right"><div class="pp_content"><div class="pp_loaderIcon"></div><div class="pp_fade"><a href="#" class="pp_expand" title="Expand the image">Expand</a><div id="pp_full_res"></div><div class="pp_details"><div class="pp_nav"><a href="#" class="pp_arrow_previous">Previous</a><p class="currentTextHolder">0/0</p><a href="#" class="pp_arrow_next">Next</a></div><p class="pp_description"></p></div></div></div></div></div></div></div><div class="pp_overlay"></div>';a(document).on("click","#cancel-comment-reply-link",function(a){c()}),a(document).on("click","a.ywar_votereview",function(b){if(b.preventDefault(),!a(this).hasClass("ywar_votereview_selected")){var c=a(this).attr("data-id_review"),d=a(this).attr("data-vote_review"),e={action:"vote_review",id_review:c,review_value:d,_wpnonce:ywar.nonce_value,return_path:window.location.href},f="#vote_yes_"+c,g="#vote_no_"+c,h=a(this).parent();h.block({message:null,overlayCSS:{background:"#fff url("+ywar.loader+") no-repeat center",opacity:.6}}),a.post(woocommerce_params.ajax_url,e,function(b){-1==b.code?top.location.replace(b.value):1==b.code&&(1==d?(a(f).addClass("vote_selected"),a(g).removeClass("vote_selected")):(a(g).addClass("vote_selected"),a(f).removeClass("vote_selected")),h.children(".ywar_review_helpful").empty().append(b.value)),h.unblock()})}}),a(document).on("click","a.review-inappropriate",function(b){b.preventDefault();var c=a(this).attr("data-id_review"),d={action:"report_inappropriate_review",id_review:c,_wpnonce:ywar.nonce_value,return_path:window.location.href},e=a(this).parent();e.block({message:null,overlayCSS:{background:"#fff url("+ywar.loader+") no-repeat center",opacity:.6}}),a.post(woocommerce_params.ajax_url,d,function(a){e.empty().append('<span class="inappropriate-content reported">'+a.value+"</span"),e.unblock()})}),a("#reviews #comments>h2").remove(),ywar.review_section_anchor&&a('a[href="#reviews"]').attr("href","#reviews_summary"),a(ywar.tab_selector).on("click","a.ywar_filter_reviews",function(f){f.preventDefault(),c();var g=a(this).attr("data-dialog");1!=g&&d("#reviews_summary"),a.post(woocommerce_params.ajax_url,e(a(this)),function(c){1!=g?(a("#reviews_header").empty().append(c.review_title),a("#comments ol.commentlist").empty().append(c.comment_list),a("div.ywar_show_more").empty().append(c.load_more),a("#reviews_summary").unblock()):(a("#reviews_dialog").empty().append('<ol class="commentlist">'+c.comment_list+"</ol>"),a("#reviews_dialog").append('<div class="ywar_show_more">'+c.load_more+"</div>"),a().prettyPhoto({markup:b,default_width:"70%",default_height:"200px",social_tools:!1,theme:"pp_woocommerce",modal:!0,callback:function(){a("#reviews_dialog").empty()}}),a.prettyPhoto.open("#reviews_dialog","",""),a("div.pp_pic_holder.pp_woocommerce").appendTo("#comments"))},"json")}),a(document).on("click","a.ywar_show_more, button.ywar_show_more_container",function(b){b.preventDefault(),c();var f=a(this);f.is("button")&&(f=f.children("a.ywar_show_more"));var g=f.attr("data-dialog");1!=g&&d(f),a.post(woocommerce_params.ajax_url,e(f),function(b){1!=g?(a("#reviews_header").empty().append(b.review_title),a("#reviews ol.commentlist").append(b.comment_list),a(f).unblock()):a("#modal_reviews ol.commentlist").append(b.comment_list),a("div.ywar_show_more").empty().append(b.load_more)},"json")}),a(ywar.tab_selector).on("click","a.ywar_filter_order",function(b){b.preventDefault(),c(),d("#reviews_order");var f=a(this);a.post(woocommerce_params.ajax_url,e(a(this)),function(b){a("#reviews_header").empty().append(b.review_title),a("ol.commentlist").empty().append(b.comment_list),a("div.ywar_show_more").empty().append(b.load_more),"most_recent_reviews"==f.attr("id")?(a("#most_recent_reviews").addClass("active"),a("#most_helpful_reviews").removeClass("active")):"most_helpful_reviews"==f.attr("id")&&(a("#most_helpful_reviews").addClass("active"),a("#most_recent_reviews").removeClass("active")),a("#reviews_order").unblock()},"json")}),a(ywar.tab_selector).on("click","a.edit-my-reviews",function(b){b.preventDefault();var d={action:"get_customer_reviews",product_id:a(this).data("product-id")};a("#ywar_reviews").block({message:null,overlayCSS:{background:"#fff url("+ywar.loader+") no-repeat center",opacity:.6}});a(this);a.post(woocommerce_params.ajax_url,d,function(b){a("#reviews_header").empty().append(b.review_title),a("ol.commentlist").empty().append(b.comment_list),a("#ywar_reviews").unblock()},"json"),c()}),a(ywar.tab_selector).on("click","a.comment-reply-link",function(b){a('select#rating option[value="5"]').prop("selected",!0),a("#title").val(""),a("textarea#comment").val(""),a("p.comment-form-rating").hide(),a("p.upload_section").hide(),a(".review_label").text(ywar.reply_to_review_title)}),a(document).on("click","a.comment-edit-link",function(b){var c=a(this).data("review-id");a("form#commentform").addClass("edit-review"),a("form#commentform").append('<input type="hidden" id="review-id" name="review-id" value="'+c+'" />'),a("p.upload_section").hide(),0!=a(this).data("parent")&&a("p.comment-form-rating").hide();var d=a(this).closest("div#comment-"+c),e=d.find("span.review_title").text();a("form#commentform #title").val(e);var f=d.find("span.review_content").text();a("form#commentform #comment").val(f);var g=a(this).data("rating");a('select#rating option[value="'+g+'"]').prop("selected",!0),a('.comment-form-rating a[class^="star-"]').removeClass("active"),a(".comment-form-rating a.star-"+g).addClass("active"),a(".review_label").text(ywar.edit_review_title)}),a(document).on("submit","form.edit-review",function(b){b.preventDefault();var d=a(this).parent();d.block({message:null,overlayCSS:{background:"#fff url("+ywar.loader+") no-repeat center",opacity:.6}});var e=a(this).find("#review-id").val(),f={action:"edit_review",review_id:e,review_title:a(this).find("#title").val(),review_content:a(this).find("#comment").val(),review_rating:a(this).find("select#rating").val()};a.post(woocommerce_params.ajax_url,f,function(b){1==b.code&&a("#li-comment-"+e).replaceWith(b.content),d.unblock()}),c()}),a(document).on("click","a.goto-reviews",function(d){d.preventDefault(),c(),a.post(woocommerce_params.ajax_url,e(a(this)),function(c){1!=open_in_dialog?(a("#reviews_header").empty().append(c.review_title),a("#comments ol.commentlist").empty().append(c.comment_list),a("div.ywar_show_more").empty().append(c.load_more),a("#reviews_summary").unblock()):(a("#reviews_dialog").empty().append('<ol class="commentlist">'+c.comment_list+"</ol>"),a("#reviews_dialog").append('<div class="ywar_show_more">'+c.load_more+"</div>"),a().prettyPhoto({markup:b,default_width:"70%",default_height:"200px",social_tools:!1,theme:"pp_woocommerce",modal:!0,callback:function(){a("#reviews_dialog").empty()}}),a.prettyPhoto.open("#reviews_dialog","",""),a("div.pp_pic_holder.pp_woocommerce").appendTo("#comments"))},"json")}),a(document).on("click","#respond form#commentform #submit",function(b){a("span.empty-review").remove();var c=ywar.is_rating_required&&!a("select#rating").val(),d=!a("#comment").val();c&&a(this).before('<span class="error empty-review">'+ywar.missing_rating_review+"</span>"),d&&a(this).before('<span class="error empty-review">'+ywar.empty_review_content+"</span>"),(c||d)&&b.preventDefault()})});